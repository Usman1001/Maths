<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculus Tools - MathsMaster LK</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500;600&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/dark-theme.css">
    <link rel="stylesheet" href="../styles/responsive.css">
    <link rel="stylesheet" href="../styles/components/navigation.css">
    <link rel="stylesheet" href="../styles/components/cards.css">
    <link rel="stylesheet" href="../styles/components/graphs.css">
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">M</div>
                    <div class="logo-text">Maths<span>Master</span> LK</div>
                </div>
                
                <nav class="main-nav" id="mainNav">
                    <ul class="nav-links">
                        <li><a href="../index.html" class="nav-link">Home</a></li>
                        <li><a href="trigonometry.html" class="nav-link">Trigonometry</a></li>
                        <li><a href="calculus.html" class="nav-link active">Calculus</a></li>
                        <li><a href="algebra.html" class="nav-link">Algebra</a></li>
                        <li><a href="statistics.html" class="nav-link">Statistics</a></li>
                        <li><a href="mechanics.html" class="nav-link">Mechanics</a></li>
                        <li><a href="pure-maths.html" class="nav-link">Pure Maths</a></li>
                    </ul>
                </nav>
                
                <div class="header-actions">
                    <button class="search-toggle" id="searchToggle">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
            
            <!-- Search Bar -->
            <div class="search-bar" id="searchBar">
                <input type="text" placeholder="Search calculus concepts..." class="search-input">
                <button class="search-close" id="searchClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html" class="breadcrumb-item">Home</a>
            <span class="breadcrumb-separator">/</span>
            <span class="breadcrumb-item active">Calculus</span>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Hero Section -->
            <section class="page-hero">
                <h1>Calculus Tools</h1>
                <p>Comprehensive calculus tools for differentiation, integration, limits, and differential equations with step-by-step solutions.</p>
            </section>

            <!-- Quick Tools Grid -->
            <section class="tools-quick-access">
                <h2>Quick Tools</h2>
                <div class="cards-grid-mini">
                    <div class="tool-card-mini" onclick="scrollToSection('derivative-calculator')">
                        <div class="tool-icon">
                            <i class="fas fa-sliders-h"></i>
                        </div>
                        <h4>Derivative Calculator</h4>
                        <p>Find derivatives of functions</p>
                    </div>
                    
                    <div class="tool-card-mini" onclick="scrollToSection('integral-calculator')">
                        <div class="tool-icon">
                            <i class="fas fa-integral"></i>
                        </div>
                        <h4>Integral Calculator</h4>
                        <p>Calculate definite & indefinite integrals</p>
                    </div>
                    
                    <div class="tool-card-mini" onclick="scrollToSection('limit-calculator')">
                        <div class="tool-icon">
                            <i class="fas fa-infinity"></i>
                        </div>
                        <h4>Limit Calculator</h4>
                        <p>Evaluate limits of functions</p>
                    </div>
                    
                    <div class="tool-card-mini" onclick="scrollToSection('area-calculator')">
                        <div class="tool-icon">
                            <i class="fas fa-border-style"></i>
                        </div>
                        <h4>Area Calculator</h4>
                        <p>Find area under curves</p>
                    </div>
                    
                    <div class="tool-card-mini" onclick="scrollToSection('taylor-series')">
                        <div class="tool-icon">
                            <i class="fas fa-expand-alt"></i>
                        </div>
                        <h4>Taylor Series</h4>
                        <p>Expand functions as power series</p>
                    </div>
                    
                    <div class="tool-card-mini" onclick="scrollToSection('differential-equations')">
                        <div class="tool-icon">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <h4>Differential Equations</h4>
                        <p>Solve basic ODEs</p>
                    </div>
                </div>
            </section>

            <!-- Derivative Calculator Section -->
            <section class="tool-section" id="derivative-calculator">
                <div class="section-header">
                    <h2>Derivative Calculator</h2>
                    <p>Calculate derivatives of functions with respect to any variable. Supports polynomials, trigonometric, exponential, and logarithmic functions.</p>
                </div>
                
                <div class="tool-interface">
                    <div class="interface-grid">
                        <div class="input-panel">
                            <div class="card">
                                <h4>Function Input</h4>
                                <form id="derivativeForm">
                                    <div class="input-group">
                                        <label for="derivativeFunction">Function f(x):</label>
                                        <input type="text" id="derivativeFunction" class="control-input" placeholder="x^2 + sin(x)" value="x^2">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="derivativeVariable">With respect to:</label>
                                        <input type="text" id="derivativeVariable" class="control-input" value="x" maxlength="1">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="derivativeOrder">Order:</label>
                                        <select id="derivativeOrder" class="control-select">
                                            <option value="1">First Derivative</option>
                                            <option value="2">Second Derivative</option>
                                            <option value="3">Third Derivative</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-actions">
                                        <button type="submit" class="action-btn primary">Calculate Derivative</button>
                                        <button type="button" class="action-btn secondary" onclick="clearDerivative()">Clear</button>
                                    </div>
                                </form>
                                
                                <div class="quick-examples">
                                    <h5>Quick Examples:</h5>
                                    <div class="example-buttons">
                                        <button class="example-btn" data-expr="x^2">x²</button>
                                        <button class="example-btn" data-expr="sin(x)">sin(x)</button>
                                        <button class="example-btn" data-expr="exp(x)">eˣ</button>
                                        <button class="example-btn" data-expr="ln(x)">ln(x)</button>
                                        <button class="example-btn" data-expr="x^3 + 2*x^2 - 5*x + 1">Polynomial</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="output-panel">
                            <div class="card">
                                <h4>Result</h4>
                                <div id="derivativeResult" class="result-content">
                                    <p>Enter a function to calculate its derivative.</p>
                                </div>
                            </div>
                            
                            <div class="card">
                                <h4>Step-by-Step Solution</h4>
                                <div id="derivativeSteps" class="steps-content">
                                    <p>The step-by-step solution will appear here.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="graph-panel">
                        <div class="card">
                            <h4>Function and Derivative Graph</h4>
                            <div class="graph-container">
                                <canvas id="derivativeGraph" width="600" height="300"></canvas>
                            </div>
                            <div class="graph-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #bb86fc;"></div>
                                    <span class="legend-label">Original Function</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background-color: #03dac6;"></div>
                                    <span class="legend-label">Derivative</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Integral Calculator Section -->
            <section class="tool-section" id="integral-calculator">
                <div class="section-header">
                    <h2>Integral Calculator</h2>
                    <p>Calculate definite and indefinite integrals using various integration methods.</p>
                </div>
                
                <div class="tool-interface">
                    <div class="interface-grid">
                        <div class="input-panel">
                            <div class="card">
                                <h4>Integral Parameters</h4>
                                <form id="integralForm">
                                    <div class="input-group">
                                        <label for="integralFunction">Function f(x):</label>
                                        <input type="text" id="integralFunction" class="control-input" placeholder="x^2" value="x^2">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="integralType">Integral Type:</label>
                                        <select id="integralType" class="control-select">
                                            <option value="indefinite">Indefinite Integral</option>
                                            <option value="definite">Definite Integral</option>
                                        </select>
                                    </div>
                                    
                                    <div id="definiteBounds" style="display: none;">
                                        <div class="input-group">
                                            <label for="lowerBound">Lower Bound (a):</label>
                                            <input type="number" id="lowerBound" class="control-input" value="0">
                                        </div>
                                        <div class="input-group">
                                            <label for="upperBound">Upper Bound (b):</label>
                                            <input type="number" id="upperBound" class="control-input" value="1">
                                        </div>
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="integrationMethod">Method:</label>
                                        <select id="integrationMethod" class="control-select">
                                            <option value="symbolic">Symbolic</option>
                                            <option value="simpson">Simpson's Rule</option>
                                            <option value="trapezoidal">Trapezoidal Rule</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-actions">
                                        <button type="submit" class="action-btn primary">Calculate Integral</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <div class="output-panel">
                            <div class="card">
                                <h4>Integration Result</h4>
                                <div id="integralResult" class="result-content">
                                    <p>Enter function and parameters to calculate integral.</p>
                                </div>
                            </div>
                            
                            <div class="card">
                                <h4>Area Visualization</h4>
                                <div class="graph-container">
                                    <canvas id="integralGraph" width="400" height="250"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Limit Calculator Section -->
            <section class="tool-section" id="limit-calculator">
                <div class="section-header">
                    <h2>Limit Calculator</h2>
                    <p>Evaluate limits of functions as the variable approaches a specific value or infinity.</p>
                </div>
                
                <div class="tool-interface">
                    <div class="calculator-card">
                        <div class="calculator-body">
                            <div class="input-grid">
                                <div class="input-group">
                                    <label for="limitFunction">Function:</label>
                                    <input type="text" id="limitFunction" class="control-input" placeholder="sin(x)/x" value="sin(x)/x">
                                </div>
                                
                                <div class="input-group">
                                    <label for="limitVariable">Variable:</label>
                                    <input type="text" id="limitVariable" class="control-input" value="x" maxlength="1">
                                </div>
                                
                                <div class="input-group">
                                    <label for="limitApproach">Approaches:</label>
                                    <input type="text" id="limitApproach" class="control-input" placeholder="0 or ∞" value="0">
                                </div>
                                
                                <div class="input-group">
                                    <label for="limitDirection">Direction:</label>
                                    <select id="limitDirection" class="control-select">
                                        <option value="both">Both Sides</option>
                                        <option value="left">Left Side (-)</option>
                                        <option value="right">Right Side (+)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="calculator-actions">
                                <button class="action-btn primary" onclick="calculateLimit()">Calculate Limit</button>
                                <button class="action-btn secondary" onclick="clearLimit()">Clear</button>
                            </div>
                            
                            <div class="calculator-result">
                                <h4>Limit Result</h4>
                                <div class="result-display" id="limitResult">
                                    lim<sub>x→0</sub> [sin(x)/x] = ?
                                </div>
                                <div id="limitSteps" class="steps-content">
                                    <!-- Step-by-step solution will appear here -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Area Calculator Section -->
            <section class="tool-section" id="area-calculator">
                <div class="section-header">
                    <h2>Area Under Curve Calculator</h2>
                    <p>Calculate the area between curves and under functions using integration.</p>
                </div>
                
                <div class="tool-interface">
                    <div class="interface-grid">
                        <div class="input-panel">
                            <div class="card">
                                <h4>Area Calculation</h4>
                                <form id="areaForm">
                                    <div class="input-group">
                                        <label for="areaFunction">Function f(x):</label>
                                        <input type="text" id="areaFunction" class="control-input" placeholder="x^2" value="x^2">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="areaLower">From x =</label>
                                        <input type="number" id="areaLower" class="control-input" value="0">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="areaUpper">To x =</label>
                                        <input type="number" id="areaUpper" class="control-input" value="2">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label for="areaAxis">Relative to:</label>
                                        <select id="areaAxis" class="control-select">
                                            <option value="xaxis">x-axis</option>
                                            <option value="yaxis">y-axis</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-actions">
                                        <button type="submit" class="action-btn primary">Calculate Area</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <div class="output-panel">
                            <div class="card">
                                <h4>Area Result</h4>
                                <div id="areaResult" class="result-content">
                                    <p>Enter function and bounds to calculate area.</p>
                                </div>
                            </div>
                            
                            <div class="card">
                                <h4>Area Visualization</h4>
                                <div class="graph-container">
                                    <canvas id="areaGraph" width="400" height="300"></canvas>
                                </div>
                                <div class="graph-controls">
                                    <button class="action-btn small" onclick="toggleAreaFill()">Toggle Fill</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Educational Content -->
            <section class="educational-section">
                <div class="section-header">
                    <h2>Calculus Concepts</h2>
                    <p>Fundamental concepts in differential and integral calculus.</p>
                </div>
                
                <div class="concepts-grid">
                    <div class="concept-card">
                        <h4>Derivative Rules</h4>
                        <ul class="concept-list">
                            <li>Power Rule: d/dx[xⁿ] = n·xⁿ⁻¹</li>
                            <li>Product Rule: (fg)' = f'g + fg'</li>
                            <li>Quotient Rule: (f/g)' = (f'g - fg')/g²</li>
                            <li>Chain Rule: (f(g(x)))' = f'(g(x))·g'(x)</li>
                        </ul>
                    </div>
                    
                    <div class="concept-card">
                        <h4>Integration Rules</h4>
                        <ul class="concept-list">
                            <li>Power Rule: ∫xⁿ dx = xⁿ⁺¹/(n+1) + C</li>
                            <li>Exponential: ∫eˣ dx = eˣ + C</li>
                            <li>Trigonometric: ∫sin(x) dx = -cos(x) + C</li>
                            <li>Substitution Rule</li>
                        </ul>
                    </div>
                    
                    <div class="concept-card">
                        <h4>Fundamental Theorem</h4>
                        <p>The Fundamental Theorem of Calculus connects differentiation and integration:</p>
                        <div class="concept-formula">
                            ∫<sub>a</sub><sup>b</sup> f'(x) dx = f(b) - f(a)
                        </div>
                    </div>
                    
                    <div class="concept-card">
                        <h4>Applications</h4>
                        <ul class="concept-list">
                            <li>Slope of tangent lines</li>
                            <li>Area under curves</li>
                            <li>Volume of solids</li>
                            <li>Related rates problems</li>
                        </ul>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <div class="logo-icon small">M</div>
                        <div class="logo-text">Maths<span>Master</span> LK</div>
                    </div>
                    <p class="footer-description">Advanced calculus tools for A/L Mathematics students.</p>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-heading">Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="#derivative-calculator">Derivatives</a></li>
                        <li><a href="#integral-calculator">Integrals</a></li>
                        <li><a href="#limit-calculator">Limits</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-heading">Related Tools</h3>
                    <ul class="footer-links">
                        <li><a href="trigonometry.html">Trigonometry</a></li>
                        <li><a href="algebra.html">Algebra</a></li>
                        <li><a href="../index.html#graph-plotter">Graph Plotter</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="copyright">
                    <p>&copy; 2023 MathsMaster LK. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/mathjs@11.6.0/lib/browser/math.js"></script>
    <script src="../scripts/navigation.js"></script>
    <script src="../scripts/ui-handler.js"></script>
    
    <script>
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                window.scrollTo({
                    top: section.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        }

        // Initialize page functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Update breadcrumb
            if (window.navigationManager) {
                window.navigationManager.updateBreadcrumb('calculus');
            }

            // Setup derivative form
            const derivativeForm = document.getElementById('derivativeForm');
            if (derivativeForm) {
                derivativeForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    calculateDerivative();
                });
            }

            // Setup integral type toggle
            const integralType = document.getElementById('integralType');
            const definiteBounds = document.getElementById('definiteBounds');
            
            if (integralType && definiteBounds) {
                integralType.addEventListener('change', function() {
                    if (this.value === 'definite') {
                        definiteBounds.style.display = 'block';
                    } else {
                        definiteBounds.style.display = 'none';
                    }
                });
            }

            // Setup example buttons
            const exampleButtons = document.querySelectorAll('.example-btn');
            exampleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const expr = this.getAttribute('data-expr');
                    document.getElementById('derivativeFunction').value = expr;
                });
            });

            // Setup area form
            const areaForm = document.getElementById('areaForm');
            if (areaForm) {
                areaForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    calculateArea();
                });
            }
        });

        // Derivative calculation
        function calculateDerivative() {
            const functionInput = document.getElementById('derivativeFunction').value;
            const variable = document.getElementById('derivativeVariable').value;
            const order = parseInt(document.getElementById('derivativeOrder').value);
            
            if (!functionInput) {
                window.uiHandler?.showToast('Please enter a function', 'error');
                return;
            }

            try {
                // Simple derivative calculation using math.js
                let derivative = functionInput;
                let steps = [];
                
                for (let i = 0; i < order; i++) {
                    // This is a simplified implementation
                    // In a real implementation, you would use proper symbolic differentiation
                    const step = `Step ${i + 1}: Differentiate with respect to ${variable}`;
                    steps.push(step);
                    
                    // Simple rules for demonstration
                    if (derivative.includes('^')) {
                        derivative = derivative.replace(/(\w+)\^(\d+)/g, function(match, base, power) {
                            const newPower = parseInt(power) - 1;
                            if (newPower === 1) {
                                return `${power}*${base}`;
                            } else if (newPower === 0) {
                                return power;
                            } else {
                                return `${power}*${base}^${newPower}`;
                            }
                        });
                    }
                }
                
                const resultElement = document.getElementById('derivativeResult');
                const stepsElement = document.getElementById('derivativeSteps');
                
                if (resultElement) {
                    resultElement.innerHTML = `
                        <div class="result-success">
                            <h4>Derivative Result:</h4>
                            <div class="math-expression">
                                f<sup>(${order})</sup>(${variable}) = ${derivative}
                            </div>
                        </div>
                    `;
                }
                
                if (stepsElement) {
                    stepsElement.innerHTML = `
                        <h4>Solution Steps:</h4>
                        <ol>
                            ${steps.map(step => `<li>${step}</li>`).join('')}
                        </ol>
                    `;
                }
                
                window.uiHandler?.showToast('Derivative calculated successfully!', 'success');
                
            } catch (error) {
                window.uiHandler?.showToast('Error calculating derivative: ' + error.message, 'error');
            }
        }

        function clearDerivative() {
            document.getElementById('derivativeFunction').value = '';
            document.getElementById('derivativeResult').innerHTML = '<p>Enter a function to calculate its derivative.</p>';
            document.getElementById('derivativeSteps').innerHTML = '<p>The step-by-step solution will appear here.</p>';
        }

        // Limit calculation
        function calculateLimit() {
            window.uiHandler?.showToast('Limit calculation feature in development', 'info');
        }

        function clearLimit() {
            document.getElementById('limitFunction').value = '';
            document.getElementById('limitResult').innerHTML = 'lim<sub>x→0</sub> [sin(x)/x] = ?';
        }

        // Area calculation
        function calculateArea() {
            window.uiHandler?.showToast('Area calculation feature in development', 'info');
        }

        function toggleAreaFill() {
            window.uiHandler?.showToast('Area visualization feature in development', 'info');
        }
    </script>
</body>
</html>